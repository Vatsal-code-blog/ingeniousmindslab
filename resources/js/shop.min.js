$(function(){
	shop_validation.init();
	
});
shop_validation = {
	init: function () {
		$('#customerForm').validate({
			rules: {
				first_name: {
					required: true
				},
				last_name: {
					required: true
				},
				shop_id: {
					required: true
				},
			},
			messages: {
				first_name: {
					required: "Please enter first_name.",
				},
				last_name: {
					required: "Please enter last_name.",
				},
				shop_id: {
					required: "Please Select shop.",
				},
			},
			submitHandler: function (form) {
				var l = Ladda.create($(form).find('button').get(0));
				l.start();
				const formData = new FormData(form);
				// console.log(formData);
				shop_app.ajaxRequest($(form).attr("action"),formData).then(function(res) {
					l.stop();
					console.log(res.data.message);
					if(res.data.success == true){
						$('#customer-list').html(res.data.customers);
						$( '#customerForm' ).each(function(){
							this.reset();
						});
						$('#data').html(res.data.form_data);
						toastr.success(res.data.message);
					}else{
						toastr.error('something went wrong!');
					}
				});
				return false;
			}
		});
	}
};

shop_app = {
	baseURL: function () {
		return $('base').attr('href');
	},
	getToken: function () {
		return $('meta[name="csrf-token"]').attr('content');
	},
	ajaxRequest: function (reqURL, reqData, reqMethod = "", reqDataType = "") {
		return axios({
			baseURL: shop_app.baseURL(),
			url: reqURL,
			method: (reqMethod != "") ? reqMethod : "post",
			headers: { 'Content-Type': "multipart/form-data" },
			data: reqData,
			async: false,
		});
	},
	notifyWithtEle: function (msg, type, pos="", timeout="") {
		pos = "";
		timeout = "";
		var noty = new Noty({
			text: msg,
			type: type,
			layout: (pos != "") ? pos : 'topRight',
			timeout: (timeout != "") ? timeout : 3000,
			progressBar: false,
			closeWith: ['click'],
			killer: true,
		});
		noty.show();
	},
};